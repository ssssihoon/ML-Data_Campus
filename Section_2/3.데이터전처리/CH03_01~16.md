# Section 3

# 1. 데이터 프레임 생성

```python
import pandas as pd
```

pandas를 불러오는 것이 필요하다.

## Dict를 통한 데이터 프레임 생성

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
# 표형식의 데이터 프레임 df 선언
print(type(df))
# <class 'pandas.core.frame.DataFrame'>
print(df)
'''
   a  b  c
0  1  4  7
1  2  5  8
2  3  6  9
'''
# 첫번째 세로축은 index이다.
```

## List를 이용한 데이터 프레임 생성

```python
import pandas as pd

a = [[1, 4, 7], [2, 5, 8], [3, 6, 9]]
df3 = pd.DataFrame(a)
print(df3)

'''
   0  1  2
0  1  4  7
1  2  5  8
2  3  6  9
'''
```

- Dict와 List의 차이점으로 주의해야할 점
    
    Dict는 세로줄(열)(Column)배열이고, List는 가로줄(행)(Row)배열이라고 생각!
    

### Columns(세로줄, 열)명 변경

```python
import pandas as pd

a = [[1, 4, 7], [2, 5, 8], [3, 6, 9]]
df3 = pd.DataFrame(a)
df3.columns = ['a', 'b', 'c']
print(df3)
'''
   a  b  c
0  1  4  7
1  2  5  8
2  3  6  9
'''
#칼럼명이 변경된 것을 알 수 있다.
```

### 예제1)

아래 테이블과 같은 데이터 프레임을 만드시오.

```python
import pandas as pd

a = {'company' : ['abc', '회사', 123], '직원수' : [400, 10, 6]}
df = pd.DataFrame(a)
print(df)

'''
  company 직원수
0     abc  400
1     회사   10
2     123    6
'''

import pandas as pd

a = [['company', '직원수'], ['abc', 400], ['회사', 10], ['123', 6]]
df = pd.DataFrame(a)
print(df)
'''
        0    1
0  company  직원수
1      abc  400
2      회사   10
3      123    6
'''
```

### 예제2)

```python
import pandas as pd
import numpy as np

a = {'company' : ['abc', '회사', 123], '직원수' : [400, 10, 6], '위치' : ['Seoul', np.NaN , 'Busan']}
# NONE값을 사용하기 위해 numpy를 이용 (np)
df1 = pd.DataFrame(a)
print(df1)

'''
  company  직원수     위치
0     abc  400  Seoul
1      회사   10    NaN
2     123    6  Busan
'''
```

# 2. 칼럼명 추출 변경

## 추출

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})

print(df.columns)
'''
Index(['a', 'b', 'c'], dtype='object')
'''
print(df.columns[1])
'''
'b'
'''
```

## 치환을 통한 칼럼명 변경

### 예제1)

칼럼명인 a, b, c를 d, e, f로 바꾸어라.

```python

import pandas as pd
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
df.columns = ['d', 'e', 'f']
print(df)
'''
   d  e  f
0  1  4  7
1  2  5  8
2  3  6  9
'''
```

### 예제2)

칼럼명인 d, e, f를 ‘디’로 f를 ‘에프’로 바꾸어라.

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
df.columns = ['d', 'e', 'f']
df.columns = ['디', 'e', '에프']
print(df)
'''
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6   9
'''
```

## rename을 통한 칼럼명 변경

- df.rename()
    
    일부분을 바꾸기 위해서는 전체의 요소를 바꾸는 것 보다 효율적이다.
    
- inplace = True를 써야 저장이 됨.

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
df.columns = ['d', 'e', 'f']

print(df.rename(columns = {'d' : '디', 'f' : '에프'}))
'''
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6   9
'''
print(df)
'''
   d  e  f
0  1  4  7
1  2  5  8
2  3  6  9
'''
df.rename(columns = {'d' : '디', 'f' : '에프'}, inplace = True)
print(df)
'''
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6 
'''

```

# 3. copy를 이용한 데이터 복사

보험용

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
df2 = df
df.columns = ['d', 'e', 'f']
df.columns = ['디', 'e', '에프']
print(df)
print(df2)
'''
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6   9
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6   9
'''
```

값을 df2로 저장(복제)을 했는데, df를 변환하면 결국 결과는 df와 df2가 같게 나온다.

하나의 df을 두개의 변수명이 공통적으로 이용한다.

→ deep copy를 통한 해결

### deep copy

`df2 = copy.deepcopy(df)`

```python
import pandas as pd
import copy
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
df2 = copy.deepcopy(df)
df.columns = ['d', 'e', 'f']
df.columns = ['디', 'e', '에프']
print(df)
print(df2)

'''
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6   9
   a  b  c
0  1  4  7
1  2  5  8
2  3  6  9
'''
```

# 4. 시리즈

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
print(df['a'])
print(type(df['a']))

'''
0    1
1    2
2    3
Name: a, dtype: int64
<class 'pandas.core.series.Series'>
'''

```

## 시리즈 생성 방법

### 열의 타입 출력

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
print(type(df['a']))

'''
0   1
1   2
2   3
pandas.core.series.Series
'''
```

인덱싱 번호와 함께 Columns 값과 형식이 출력

but → Series를 이용해 바로 시리즈를 만들 수 있다.

### 시리즈 생성 방법

```python
import pandas as pd

a = pd.Series([1, 2, 3, 1, 2, 3])
print(a)

'''
0    1
1    2
2    3
3    1
4    2
5    3
dtype: int64
'''
```

### 인덱스 변경

```python
import pandas as pd

a = pd.Series([1, 2, 3, 1, 2, 3], index = ['a', 'b', 'c', 'd', 'e', 'f'])
print(a)

'''
a    1
b    2
c    3
d    1
e    2
f    3
dtype: int64
'''

print(['e'])
'''
2
'''
```

### 유일한 값 찾기(set과 유사)

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3, 1, 2, 3], 'b' : [4, 5, 6, 6, 7, 8], 'c' : [7, 8, 9, 10, 11, 12]})
a = df['a']
print(a)

'''
0    1
1    2
2    3
3    1
4    2
5    3
Name: a, dtype: int64
'''
print(a.unique())
'''
[1 2 3]
'''
print(a.unique()[2])
'''
3 #인덱싱 가능
'''
```

# 5. loc과 iloc을 이용한 원하는 위치의 데이터 추출

### 예제1)

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]})
print(df)
'''
    a   b   c
0   1  11  21
1   2  12  22
2   3  13  23
3   4  14  24
4   5  15  25
5   6  16  26
6   7  17  27
7   8  18  28
8   9  19  29
9  10  20  30
'''
print(df[['a', 'b']])

'''
a   b
0   1  11
1   2  12
2   3  13
3   4  14
4   5  15
5   6  16
6   7  17
7   8  18
8   9  19
9  10  20
'''
```

대괄호를 양옆에 하나씩 추가해주면 된다.

일반적으로는 오류가 뜸

### 예제2)

첫 번째 행을 추출하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'e' : [i for i in range(21, 31)]})
print(df[0])
'''
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sihoon/Desktop/FastCampus/CH03_05/ex2.py", line 4, in <module>
    print(df[0])
          ~~^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 0
'''
```

일반적으로 생각해서 추출하면 오류가 뜬다

→ loc를 통해 해결하면 된다.

- loc를 통한 해결 (슬라이스도 가능)

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'e' : [i for i in range(21, 31)]})
print(df.loc[0])
'''
a     1
b    11
e    21
Name: 0, dtype: int64
'''

```

## 인덱스가 문자로 이루어진 데이터 프레임 생성

```python
import pandas as pd

index = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'g', 'h', 'i']
df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'e' : [i for i in range(21, 31)]}, index = index)
print(df)
# index 목록에 index 변수를 넣겠다.

'''
    a   b   e
a   1  11  21
b   2  12  22
c   3  13  23
d   4  14  24
e   5  15  25
f   6  16  26
g   7  17  27
g   8  18  28
h   9  19  29
i  10  20  30
'''
```

### 예제3)

 index 추출

```python
import pandas as pd

index = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'g', 'h', 'i']
df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'e' : [i for i in range(21, 31)]}, index = index)
print(df.loc[0])
'''
KeyError: 0
'''

print(df.loc['g'])

'''
a   b   e
g  7  17  27
g  8  18  28
'''
```

index 목록에 0값이 없기 때문에 ERROE가 나옴

그러므로 목록에 있는 항목인 ‘g’값 추출

### 예제4)

열이 g,c 이며 인덱스가 g, i 인 데이터를 추출하시오.

```python
import pandas as pd

index = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'g', 'h', 'i']
df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]}, index = index)
print(df.loc[['g', 'i'], ['a', 'c']])

'''
    a   c
g   7  27
g   8  28
i  10  30
'''
```

### 예제5)

- 처음부터 5번째 까지의 데이터와 첫 번째 열과 세번째 열의 데이터를 추출하시오.

→iloc를 통한 해결

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]})
print(df.iloc[:5, [0, 2]])

'''
   a   c
0  1  21
1  2  22
2  3  23
3  4  24
4  5  25
'''
```

### 예제6)

- 처음부터 5번째 까지의 데이터와 첫 번째 열과 세번째 열의 데이터를 추출하시오.

```python
import pandas as pd

index = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'g', 'h', 'i']
df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]}, index = index)
print(df.iloc[:5, [0, 2]])
'''
   a   c
a  1  21
b  2  22
c  3  23
d  4  24
e  5  25
'''
```

# 6. 조건에 맞는 데이터 추출

### 예제1)

- a, c열을 출력하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]})
print(df[['a', 'c']])

'''
    a   c
0   1  21
1   2  22
2   3  23
3   4  24
4   5  25
5   6  26
6   7  27
7   8  28
8   9  29
9  10  30
'''
```
