# CH03

- [1. 데이터 프레임 생성](#1-데이터-프레임-생성)
  - [Dict를 통한 데이터 프레임 생성](#dict를-통한-데이터-프레임-생성)
  - [List를 이용한 데이터 프레임 생성](#list를-이용한-데이터-프레임-생성)
    - [Columns(세로줄, 열)명 변경](#columns세로줄-열명-변경)
- [2. 칼럼명 추출 변경](#2-칼럼명-추출-변경)
  - [추출](#추출)
  - [치환을 통한 칼럼명 변경](#치환을-통한-칼럼명-변경)
  - [rename을 통한 칼럼명 변경](#rename을-통한-칼럼명-변경)
- [3. copy를 이용한 데이터 복사](#3-copy를-이용한-데이터-복사)
    - [deep copy](#deep-copy)
- [4. 시리즈](#4-시리즈)
  - [시리즈 생성 방법](#시리즈-생성-방법)
    - [열의 타입 출력](#열의-타입-출력)
    - [시리즈 생성 방법](#시리즈-생성-방법-1)
    - [인덱스 변경](#인덱스-변경)
    - [유일한 값 찾기(set과 유사)](#유일한-값-찾기set과-유사)
- [5. loc과 iloc을 이용한 원하는 위치의 데이터 추출](#5-loc과-iloc을-이용한-원하는-위치의-데이터-추출)
  - [인덱스가 문자로 이루어진 데이터 프레임 생성](#인덱스가-문자로-이루어진-데이터-프레임-생성)
- [6. 조건에 맞는 데이터 추출](#6-조건에-맞는-데이터-추출)

- [7. 정렬](#7-정렬)
    - [인덱스 기준 정렬 (오름차순)](#인덱스-기준-정렬-오름차순)
    - [인덱스 기준 정렬 (내림차순)](#인덱스-기준-정렬-내림차순)
    - [인덱스 초기화](#인덱스-초기화)
  - [값 기준 정렬](#값-기준-정렬)

- [8. 결측값 처리](#8-결측값-처리)
  - [결측 유무 확인](#결측-유무-확인)
    - [df.isnull()](#dfisnull)
  - [결측값 개수 확인](#결측값-개수-확인)
    - [df.isnull().sum()](#dfisnullsum)
  - [결측값이 포함된 행 지우기](#결측값이-포함된-행-지우기)
    - [df.dropna()](#dfdropna)
  - [결측값이 포함된 열 지우기](#결측값이-포함된-열-지우기)
    - [df.dropna(axis = 1)](#dfdropnaaxis--1)
  - [결측값을 다른 값으로 대체하기](#결측값을-다른-값으로-대체하기)
    - [df.fillna(값, inplace = True)](#dffillna값-inplace--true)
  - [앞이나 뒤의 숫자로 바꾸기](#앞이나-뒤의-숫자로-바꾸기)
    - [뒤의 값으로 채우기](#뒤의-값으로-채우기)
    - [앞의 값으로 채우기](#앞의-값으로-채우기)
  - [limit 설정](#limit-설정)
  - [평균으로 대체하기](#평균으로-대체하기)
    - [df.mean()](#dfmean)
    - [전체를 평균에 넣기](#전체를-평균에-넣기)
- [9. 타입 변환](#9-타입-변환)
  - [실수 형태에서 정수 형태로 변환](#실수-형태에서-정수-형태로-변환)
  - [datetime](#datetime)
- [10. 레코드, 칼럼 추가 삭제](#10-레코드-칼럼-추가-삭제)
  - [칼럼 삭제](#칼럼-삭제)
  - [레코드 추가(가로열, 행)](#레코드-추가가로열-행)
- [11. apply, map을 활용한 데이터변환](#11-apply-map을-활용한-데이터변환)
- [12. 데이터프레임 결합\_상하 결합](#12-데이터프레임-결합_상하-결합)
    - [데이터 프레임 결합](#데이터-프레임-결합)
  - [상하 결합](#상하-결합)
    - [필드의 순서가 섞였을 때 결합 결과 확인](#필드의-순서가-섞였을-때-결합-결과-확인)
    - [서로 다른 필드로 구성되어 있는 데이터 프레임의 결합](#서로-다른-필드로-구성되어-있는-데이터-프레임의-결합)
- [13. 데이터 프레임 결합\_좌우 결합](#13-데이터-프레임-결합_좌우-결합)
- [14. 그룹화](#14-그룹화)
- [15. 피벗테이블](#15-피벗테이블)
  - [피벗테이블 만들기](#피벗테이블-만들기)
  - [random 라이브러리](#random-라이브러리)
- [16. 파일호출\_저장](#16-파일호출_저장)
    - [파일 호출](#파일-호출)
    - [파일의 양이 많은 경우 요약하는 방법](#파일의-양이-많은-경우-요약하는-방법)
    - [파일 저장](#파일-저장)

# 1. 데이터 프레임 생성

```python
import pandas as pd
```

pandas를 불러오는 것이 필요하다.

## Dict를 통한 데이터 프레임 생성

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
# 표형식의 데이터 프레임 df 선언
print(type(df))
# <class 'pandas.core.frame.DataFrame'>
print(df)
'''
   a  b  c
0  1  4  7
1  2  5  8
2  3  6  9
'''
# 첫번째 세로축은 index이다.
```

## List를 이용한 데이터 프레임 생성

```python
import pandas as pd

a = [[1, 4, 7], [2, 5, 8], [3, 6, 9]]
df3 = pd.DataFrame(a)
print(df3)

'''
   0  1  2
0  1  4  7
1  2  5  8
2  3  6  9
'''
```

- Dict와 List의 차이점으로 주의해야할 점
    
    Dict는 세로줄(열)(Column)배열이고, List는 가로줄(행)(Row)배열이라고 생각!
    

### Columns(세로줄, 열)명 변경

```python
import pandas as pd

a = [[1, 4, 7], [2, 5, 8], [3, 6, 9]]
df3 = pd.DataFrame(a)
df3.columns = ['a', 'b', 'c']
print(df3)
'''
   a  b  c
0  1  4  7
1  2  5  8
2  3  6  9
'''
#칼럼명이 변경된 것을 알 수 있다.
```

### 예제1)

아래 테이블과 같은 데이터 프레임을 만드시오.

```python
import pandas as pd

a = {'company' : ['abc', '회사', 123], '직원수' : [400, 10, 6]}
df = pd.DataFrame(a)
print(df)

'''
  company 직원수
0     abc  400
1     회사   10
2     123    6
'''

import pandas as pd

a = [['company', '직원수'], ['abc', 400], ['회사', 10], ['123', 6]]
df = pd.DataFrame(a)
print(df)
'''
        0    1
0  company  직원수
1      abc  400
2      회사   10
3      123    6
'''
```

### 예제2)

```python
import pandas as pd
import numpy as np

a = {'company' : ['abc', '회사', 123], '직원수' : [400, 10, 6], '위치' : ['Seoul', np.NaN , 'Busan']}
# NONE값을 사용하기 위해 numpy를 이용 (np)
df1 = pd.DataFrame(a)
print(df1)

'''
  company  직원수     위치
0     abc  400  Seoul
1      회사   10    NaN
2     123    6  Busan
'''
```

# 2. 칼럼명 추출 변경

## 추출

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})

print(df.columns)
'''
Index(['a', 'b', 'c'], dtype='object')
'''
print(df.columns[1])
'''
'b'
'''
```

## 치환을 통한 칼럼명 변경

### 예제1)

칼럼명인 a, b, c를 d, e, f로 바꾸어라.

```python

import pandas as pd
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
df.columns = ['d', 'e', 'f']
print(df)
'''
   d  e  f
0  1  4  7
1  2  5  8
2  3  6  9
'''
```

### 예제2)

칼럼명인 d, e, f를 ‘디’로 f를 ‘에프’로 바꾸어라.

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
df.columns = ['d', 'e', 'f']
df.columns = ['디', 'e', '에프']
print(df)
'''
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6   9
'''
```

## rename을 통한 칼럼명 변경

- df.rename()
    
    일부분을 바꾸기 위해서는 전체의 요소를 바꾸는 것 보다 효율적이다.
    
- inplace = True를 써야 저장이 됨.

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
df.columns = ['d', 'e', 'f']

print(df.rename(columns = {'d' : '디', 'f' : '에프'}))
'''
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6   9
'''
print(df)
'''
   d  e  f
0  1  4  7
1  2  5  8
2  3  6  9
'''
df.rename(columns = {'d' : '디', 'f' : '에프'}, inplace = True)
print(df)
'''
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6 
'''

```

# 3. copy를 이용한 데이터 복사

보험용

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
df2 = df
df.columns = ['d', 'e', 'f']
df.columns = ['디', 'e', '에프']
print(df)
print(df2)
'''
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6   9
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6   9
'''
```

값을 df2로 저장(복제)을 했는데, df를 변환하면 결국 결과는 df와 df2가 같게 나온다.

하나의 df을 두개의 변수명이 공통적으로 이용한다.

→ deep copy를 통한 해결

### deep copy

`df2 = copy.deepcopy(df)`

```python
import pandas as pd
import copy
df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
df2 = copy.deepcopy(df)
df.columns = ['d', 'e', 'f']
df.columns = ['디', 'e', '에프']
print(df)
print(df2)

'''
   디  e  에프
0  1  4   7
1  2  5   8
2  3  6   9
   a  b  c
0  1  4  7
1  2  5  8
2  3  6  9
'''
```

# 4. 시리즈

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
print(df['a'])
print(type(df['a']))

'''
0    1
1    2
2    3
Name: a, dtype: int64
<class 'pandas.core.series.Series'>
'''

```

## 시리즈 생성 방법

### 열의 타입 출력

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3], 'b' : [4, 5, 6], 'c' : [7, 8, 9]})
print(type(df['a']))

'''
0   1
1   2
2   3
pandas.core.series.Series
'''
```

인덱싱 번호와 함께 Columns 값과 형식이 출력

but → Series를 이용해 바로 시리즈를 만들 수 있다.

### 시리즈 생성 방법

```python
import pandas as pd

a = pd.Series([1, 2, 3, 1, 2, 3])
print(a)

'''
0    1
1    2
2    3
3    1
4    2
5    3
dtype: int64
'''
```

### 인덱스 변경

```python
import pandas as pd

a = pd.Series([1, 2, 3, 1, 2, 3], index = ['a', 'b', 'c', 'd', 'e', 'f'])
print(a)

'''
a    1
b    2
c    3
d    1
e    2
f    3
dtype: int64
'''

print(['e'])
'''
2
'''
```

### 유일한 값 찾기(set과 유사)

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3, 1, 2, 3], 'b' : [4, 5, 6, 6, 7, 8], 'c' : [7, 8, 9, 10, 11, 12]})
a = df['a']
print(a)

'''
0    1
1    2
2    3
3    1
4    2
5    3
Name: a, dtype: int64
'''
print(a.unique())
'''
[1 2 3]
'''
print(a.unique()[2])
'''
3 #인덱싱 가능
'''
```

# 5. loc과 iloc을 이용한 원하는 위치의 데이터 추출

### 예제1)

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]})
print(df)
'''
    a   b   c
0   1  11  21
1   2  12  22
2   3  13  23
3   4  14  24
4   5  15  25
5   6  16  26
6   7  17  27
7   8  18  28
8   9  19  29
9  10  20  30
'''
print(df[['a', 'b']])

'''
a   b
0   1  11
1   2  12
2   3  13
3   4  14
4   5  15
5   6  16
6   7  17
7   8  18
8   9  19
9  10  20
'''
```

대괄호를 양옆에 하나씩 추가해주면 된다.

일반적으로는 오류가 뜸

### 예제2)

첫 번째 행을 추출하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'e' : [i for i in range(21, 31)]})
print(df[0])
'''
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sihoon/Desktop/FastCampus/CH03_05/ex2.py", line 4, in <module>
    print(df[0])
          ~~^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 0
'''
```

일반적으로 생각해서 추출하면 오류가 뜬다

→ loc를 통해 해결하면 된다.

- loc를 통한 해결 (슬라이스도 가능)

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'e' : [i for i in range(21, 31)]})
print(df.loc[0])
'''
a     1
b    11
e    21
Name: 0, dtype: int64
'''

```

## 인덱스가 문자로 이루어진 데이터 프레임 생성

```python
import pandas as pd

index = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'g', 'h', 'i']
df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'e' : [i for i in range(21, 31)]}, index = index)
print(df)
# index 목록에 index 변수를 넣겠다.

'''
    a   b   e
a   1  11  21
b   2  12  22
c   3  13  23
d   4  14  24
e   5  15  25
f   6  16  26
g   7  17  27
g   8  18  28
h   9  19  29
i  10  20  30
'''
```

### 예제3)

 index 추출

```python
import pandas as pd

index = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'g', 'h', 'i']
df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'e' : [i for i in range(21, 31)]}, index = index)
print(df.loc[0])
'''
KeyError: 0
'''

print(df.loc['g'])

'''
a   b   e
g  7  17  27
g  8  18  28
'''
```

index 목록에 0값이 없기 때문에 ERROE가 나옴

그러므로 목록에 있는 항목인 ‘g’값 추출

### 예제4)

열이 g,c 이며 인덱스가 g, i 인 데이터를 추출하시오.

```python
import pandas as pd

index = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'g', 'h', 'i']
df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]}, index = index)
print(df.loc[['g', 'i'], ['a', 'c']])

'''
    a   c
g   7  27
g   8  28
i  10  30
'''
```

### 예제5)

- 처음부터 5번째 까지의 데이터와 첫 번째 열과 세번째 열의 데이터를 추출하시오.

→iloc를 통한 해결

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]})
print(df.iloc[:5, [0, 2]])

'''
   a   c
0  1  21
1  2  22
2  3  23
3  4  24
4  5  25
'''
```

### 예제6)

- 처음부터 5번째 까지의 데이터와 첫 번째 열과 세번째 열의 데이터를 추출하시오.

```python
import pandas as pd

index = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'g', 'h', 'i']
df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]}, index = index)
print(df.iloc[:5, [0, 2]])
'''
   a   c
a  1  21
b  2  22
c  3  23
d  4  24
e  5  25
'''
```

# 6. 조건에 맞는 데이터 추출

### 예제1)

- a, c열을 출력하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]})
print(df[['a', 'c']])

'''
    a   c
0   1  21
1   2  22
2   3  23
3   4  24
4   5  25
5   6  26
6   7  27
7   8  28
8   9  29
9  10  30
'''
```

### 예제2)

- a가 3이상인 데이터를 출력하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]})
print(df[df['a'] >= 3])

'''
    a   b   c
2   3  13  23
3   4  14  24
4   5  15  25
5   6  16  26
6   7  17  27
7   8  18  28
8   9  19  29
9  10  20  30
'''

```

### 예제3)

- a가 3이상인 데이터 중 a,c 열만 출력하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]})
print(df[df['a'] >= 3][['a', 'c']])

'''
    a   c
2   3  23
3   4  24
4   5  25
5   6  26
6   7  27
7   8  28
8   9  29
9  10  30
'''
```

### 예제4)

- a가 3이상이고, b가 16미만인 데이터를 출력하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]})
print(df[(df['a'] >= 3) & (df['b'] < 16)])

'''
   a   b   c
2  3  13  23
3  4  14  24
4  5  15  25

'''
```

### 예제5)

- a 가 3이하 이거나 7 이상인 데이터를 출력하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]})
print(df[(df['a'] <= 3) | (df['a'] >= 7)])

'''
a   b   c
0   1  11  21
1   2  12  22
2   3  13  23
6   7  17  27
7   8  18  28
8   9  19  29
9  10  20  30
'''
```

### 예제6)

- a가 3이상이고, b가 16미만이거나 c가 30인 데이터를 출력하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [i for i in range(1, 11)], 'b' : [i for i in range(11, 21)], 'c' : [i for i in range(21, 31)]})
print(df[(df['a'] >=3) & ((df['b'] < 16) | (df['c'] == 30))])

'''
    a   b   c
2   3  13  23
3   4  14  24
4   5  15  25
9  10  20  30
'''

```

# 7. 정렬

초기화 → drop = True

내림차순 → ascending = False    (오름차순인 경우엔 그저 sort()지만, ascending = True로도 나타낼 수 있다.

저장 ⇒ inplace = True

### 인덱스 기준 정렬 (오름차순)

```python
import pandas as pd

df = pd.DataFrame({'a' : [2, 3, 2, 7, 4], 'b' : [2, 1, 3, 5, 3], 'c' : [1, 1, 2, 3, 5]})

df.sort_index()
print(df)

'''
   a  b  c
0  2  2  1
1  3  1  1
2  2  3  2
3  7  5  3
4  4  3  5
'''
```

### 인덱스 기준 정렬 (내림차순)

- ascending = False

```python
import pandas as pd

df = pd.DataFrame({'a' : [2, 3, 2, 7, 4], 'b' : [2, 1, 3, 5, 3], 'c' : [1, 1, 2, 3, 5]})

print(df.sort_index(ascending = False))

'''
   a  b  c
4  4  3  5
3  7  5  3
2  2  3  2
1  3  1  1
0  2  2  1
'''
```

```python
mport pandas as pd

df = pd.DataFrame({'a' : [2, 3, 2, 7, 4], 'b' : [2, 1, 3, 5, 3], 'c' : [1, 1, 2, 3, 5]})

df.sort_index(ascending = False, inplace = True)
print(df)

'''
   a  b  c
4  4  3  5
3  7  5  3
2  2  3  2
1  3  1  1
0  2  2  1
'''
```

inplace = True를 써줘야 df값에 저장이 된다.

안하면 원래 df값이 나옴.

### 인덱스 초기화

값들은 그대로 두고 인덱스만 초기화를 시키고 싶을때, 

→ df.reset_index()

```python
import pandas as pd

df = pd.DataFrame({'a' : [2, 3, 2, 7, 4], 'b' : [2, 1, 3, 5, 3], 'c' : [1, 1, 2, 3, 5]})

df.sort_index(ascending = False)
print(df.reset_index())

'''
   index  a  b  c
0      0  2  2  1
1      1  3  1  1
2      2  2  3  2
3      3  7  5  3
4      4  4  3  5
'''
```

이처럼 제대로 저장이 되지 않음

→drop = True를 사용

```python
import pandas as pd

df = pd.DataFrame({'a' : [2, 3, 2, 7, 4], 'b' : [2, 1, 3, 5, 3], 'c' : [1, 1, 2, 3, 5]})

q = df.sort_index(ascending = False)
w = q.reset_index(drop = True)
print(w)

'''
   a  b  c
0  4  3  5
1  7  5  3
2  2  3  2
3  3  1  1
4  2  2  1
'''
```

## 값 기준 정렬

### 예제1)

- a열 기준으로 오름차순 정렬하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [2, 3, 2, 7, 4], 'b' : [2, 1, 3, 5, 3], 'c' : [1, 1, 2, 3, 5]})

df.sort_values(by = ['a'], inplace = True)
print(df)

'''
   a  b  c
0  2  2  1
2  2  3  2
1  3  1  1
4  4  3  5
3  7  5  3
'''
```

### 예제2)

- a열 기준으로 내림차순 정렬하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [2, 3, 2, 7, 4], 'b' : [2, 1, 3, 5, 3], 'c' : [1, 1, 2, 3, 5]})

df.sort_values(by = ['a'], inplace = True, ascending=False)
print(df)

'''
   a  b  c
3  7  5  3
4  4  3  5
1  3  1  1
0  2  2  1
2  2  3  2
'''
```

### 예제3)

- a, b열을 기준으로 오름차순 정렬하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [2, 3, 2, 7, 4], 'b' : [2, 1, 3, 5, 3], 'c' : [1, 1, 2, 3, 5]})

df.sort_values(by = ['a', 'b'], inplace = True)
print(df)

'''
   a  b  c
0  2  2  1
2  2  3  2
1  3  1  1
4  4  3  5
3  7  5  3
'''
```

### 예제4)

- a,열을 기준으로 오름차순 정렬 후 b열 기준으로 내림차순 정렬하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [2, 3, 2, 7, 4], 'b' : [2, 1, 3, 5, 3], 'c' : [1, 1, 2, 3, 5]})

df.sort_values(by = ['a', 'b'], inplace = True, ascending= [True, False])
print(df)

'''
   a  b  c
2  2  3  2
0  2  2  1
1  3  1  1
4  4  3  5
3  7  5  3
'''
```

# 8. 결측값 처리

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a' : [1, 2, 3, 4, 5], 'b' : [2, 3, np.nan,3 ,4], 'c' : [3, 4, 7, 6, 4]})
print(df)

'''
   a    b  c
0  1  2.0  3
1  2  3.0  4
2  3  NaN  7
3  4  3.0  6
4  5  4.0  4
'''
```

## 결측 유무 확인

### df.isnull()

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a' : [1, 2, 3, 4, 5], 'b' : [2, 3, np.nan,3 ,4], 'c' : [3, 4, 7, 6, 4]})
print(df.isnull())

'''
     a      b      c
0  False  False  False
1  False  False  False
2  False   True  False
3  False  False  False
4  False  False  False
'''

```

## 결측값 개수 확인

### df.isnull().sum()

count()는 그저 값의 개수만 출력

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a' : [1, 2, 3, 4, 5], 'b' : [2, 3, np.nan,3 ,4], 'c' : [3, 4, 7, 6, 4]})
print(df.isnull().sum())

'''
a    0
b    1
c    0
dtype: int64
'''
```

## 결측값이 포함된 행 지우기

### df.dropna()

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a' : [1, 2, 3, 4, 5], 'b' : [2, 3, np.nan,3 ,4], 'c' : [3, 4, 7, 6, 4]})
print(df.dropna())

'''
   a    b  c
0  1  2.0  3
1  2  3.0  4
3  4  3.0  6
4  5  4.0  4
'''
```

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a' : [1, 2, 3, 4, 5], 'b' : [2, 3, np.nan,3 ,4], 'c' : [3, 4, 7, 6, 4]})
df.dropna(inplace = True)
print(df)

'''
   a    b  c
0  1  2.0  3
1  2  3.0  4
3  4  3.0  6
4  5  4.0  4
'''
```

## 결측값이 포함된 열 지우기

### df.dropna(axis = 1)

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a' : [1, 2, 3, 4, 5], 'b' : [2, 3, np.nan,3 ,4], 'c' : [3, 4, 7, 6, 4]})
df.dropna(axis = 1, inplace = True)
print(df)

'''
   a  c
0  1  3
1  2  4
2  3  7
3  4  6
4  5  4
'''
```

## 결측값을 다른 값으로 대체하기

### df.fillna(값, inplace = True)

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a' : [1, 2, 3, 4, 5], 'b' : [2, 3, np.nan,3 ,4], 'c' : [3, 4, 7, 6, 4]})
df.fillna(0, inplace = True)
print(df)

'''
   a    b  c
0  1  2.0  3
1  2  3.0  4
2  3  0.0  7
3  4  3.0  6
4  5  4.0  4
'''
```

## 앞이나 뒤의 숫자로 바꾸기

### 뒤의 값으로 채우기

df.fillna(method = ‘bfill’)

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a' : [1, 1, 3, 4, np.nan], 'b' : [2, 3, np.nan, np.nan, 4], 'c' : [np.nan, 4, 1, 1, 4]})
df.fillna(method = "bfill", inplace= True)
print(df)

'''
   a    b    c
0  1.0  2.0  4.0
1  1.0  3.0  4.0
2  3.0  4.0  1.0
3  4.0  4.0  1.0
4  NaN  4.0  4.0
'''
```

### 앞의 값으로 채우기

df.fillna(method = ‘afill’)

## limit 설정

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a' : [1, 1, 3, 4, np.nan], 'b' : [2, 3, np.nan, np.nan, 4], 'c' : [np.nan, 4, 1, 1, 4]})
print(df.fillna(method = 'ffill', limit = 1))

'''
   a    b    c
0  1.0  2.0  NaN
1  1.0  3.0  4.0
2  3.0  3.0  1.0
3  4.0  NaN  1.0
4  4.0  4.0  4.0
'''
```

ffill limit = 1 : 한번만 (앞 값)가져오겠다.

## 평균으로 대체하기

### df.mean()

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a' : [1, 1, 3, 4, np.nan], 'b' : [2, 3, np.nan, np.nan, 4], 'c' : [np.nan, 4, 1, 1, 4]})
print(df.mean()['a'])

#a열 값의 평균을 구함
'''
2.25
'''
```

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a' : [1, 1, 3, 4, np.nan], 'b' : [2, 3, np.nan, np.nan, 4], 'c' : [np.nan, 4, 1, 1, 4]})
print(df.fillna(df.mean()['a']))

'''
    a     b     c
0  1.00  2.00  2.25
1  1.00  3.00  4.00
2  3.00  2.25  1.00
3  4.00  2.25  1.00
4  2.25  4.00  4.00
'''
#평균을 nan 값에 채워줌
```

### 전체를 평균에 넣기

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'a': [1, 1, 3, 4, np.nan], 'b': [2, 3, np.nan, np.nan, 4], 'c': [np.nan, 4, 1, 1, 4]})
df.fillna(df.mean(), inplace=True)
print(df)

'''
   a    b    c
0  1.00  2.0  2.5
1  1.00  3.0  4.0
2  3.00  3.0  1.0
3  4.00  3.0  1.0
4  2.25  4.0  4.0
'''
```

# 9. 타입 변환

```python
import pandas as pd

df = pd.DataFrame({'판매일' : ['5/11/21', '5/12/21', '5/13/21', '5/14/21', '5/15/21'], '판매량' : ['10', '15', '20', '25', '30'], '방문자수' : ['10','-', '17', '23', '25'], '기온' : ['24.1', '24.3', '24.8', '25', '25.4']})
print(df)

'''
   판매일 판매량 방문자수    기온
0  5/11/21  10   10  24.1
1  5/12/21  15    -  24.3
2  5/13/21  20   17  24.8
3  5/14/21  25   23    25
4  5/15/21  30   25  25.4
'''
```

- 타입 확인

```python
import pandas as pd

df = pd.DataFrame({'판매일' : ['5/11/21', '5/12/21', '5/13/21', '5/14/21', '5/15/21'], '판매량' : ['10', '15', '20', '25', '30'], '방문자수' : ['10','-', '17', '23', '25'], '기온' : ['24.1', '24.3', '24.8', '25', '25.4']})
print(df.dtypes)

'''
판매일     object
판매량     object
방문자수    object
기온      object
dtype: object
'''
```

열 추가

```python
import pandas as pd

df = pd.DataFrame({'판매일' : ['5/11/21', '5/12/21', '5/13/21', '5/14/21', '5/15/21'], '판매량' : ['10', '15', '20', '25', '30'], '방문자수' : ['10','-', '17', '23', '25'], '기온' : ['24.1', '24.3', '24.8', '25', '25.4']})
df['판매량 보정'] = df['판매량'] + 1

'''
TypeError: can only concatenate str (not "int") to str
'''
```

오브젝트라는 형식으로는 덧셈 뺄셈 불가

### 예제1)

- 판매량을 정수 형태로 변환 하시오.

```python
import pandas as pd

df = pd.DataFrame({'판매일' : ['5/11/21', '5/12/21', '5/13/21', '5/14/21', '5/15/21'], '판매량' : ['10', '15', '20', '25', '30'], '방문자수' : ['10','-', '17', '23', '25'], '기온' : ['24.1', '24.3', '24.8', '25', '25.4']})
df.astype({'판매량' : 'int'})
print(df.dtypes)

'''
판매일     object
판매량     object
방문자수    object
기온      object
dtype: object
'''
```

int로 바뀌지 않았음.

df 변수를 다시 할당

```python
import pandas as pd

df = pd.DataFrame({'판매일' : ['5/11/21', '5/12/21', '5/13/21', '5/14/21', '5/15/21'], '판매량' : ['10', '15', '20', '25', '30'], '방문자수' : ['10','-', '17', '23', '25'], '기온' : ['24.1', '24.3', '24.8', '25', '25.4']})
df = df.astype({'판매량' : 'int'})
print(df.dtypes)

df['판매량 보정'] = df['판매량'] + 1
print(df)

'''
판매일     object
판매량      int64
방문자수    object
기온      object
dtype: object
       판매일  판매량 방문자수    기온  판매량 보정
0  5/11/21   10   10  24.1      11
1  5/12/21   15    -  24.3      16
2  5/13/21   20   17  24.8      21
3  5/14/21   25   23    25      26
4  5/15/21   30   25  25.4      31
'''
```

### 예제2)

- 방문자수를 숫자 타입으로 변형 하시오.

```python
import pandas as pd

df = pd.DataFrame({'판매일' : ['5/11/21', '5/12/21', '5/13/21', '5/14/21', '5/15/21'], '판매량' : ['10', '15', '20', '25', '30'], '방문자수' : ['10','-', '17', '23', '25'], '기온' : ['24.1', '24.3', '24.8', '25', '25.4']})
df = df.astype({'방문자수' : 'int'})
print(df)

'''
ValueError: invalid literal for int() with base 10: '-': Error while type casting for column '방문자수'
'''
```

‘-’라는 값 때문에 에러가 뜸

→ to_numeric() 사용

astype과 같은 의미

```python
import pandas as pd

df = pd.DataFrame({'판매일' : ['5/11/21', '5/12/21', '5/13/21', '5/14/21', '5/15/21'], '판매량' : ['10', '15', '20', '25', '30'], '방문자수' : ['10','-', '17', '23', '25'], '기온' : ['24.1', '24.3', '24.8', '25', '25.4']})
pd.to_numeric(df['방문자수'])
print(df)

'''
ValueError: Unable to parse string "-" at position 1
'''
```

에러 발생

에러 발생시 ‘coerce’ 를 출력하게 만든다.

```python
import pandas as pd

df = pd.DataFrame({'판매일' : ['5/11/21', '5/12/21', '5/13/21', '5/14/21', '5/15/21'], '판매량' : ['10', '15', '20', '25', '30'], '방문자수' : ['10','-', '17', '23', '25'], '기온' : ['24.1', '24.3', '24.8', '25', '25.4']})
df = pd.to_numeric(df['방문자수'], errors='coerce')
print(df)

'''
0    10.0
1     NaN
2    17.0
3    23.0
4    25.0
Name: 방문자수, dtype: float64
'''
```

에러나지 않게 만든 후 다시 숫자로 변환

```python
import pandas as pd

df = pd.DataFrame({'판매일' : ['5/11/21', '5/12/21', '5/13/21', '5/14/21', '5/15/21'], '판매량' : ['10', '15', '20', '25', '30'], '방문자수' : ['10','-', '17', '23', '25'], '기온' : ['24.1', '24.3', '24.8', '25', '25.4']})
df['방문자수'] = pd.to_numeric(df['방문자수'], errors='coerce')
print(df)
print(df.dtypes)

'''
    판매일 판매량  방문자수    기온
0  5/11/21  10  10.0  24.1
1  5/12/21  15   NaN  24.3
2  5/13/21  20  17.0  24.8
3  5/14/21  25  23.0    25
4  5/15/21  30  25.0  25.4
판매일      object
판매량      object
방문자수    float64
기온       object
dtype: object
'''
```

## 실수 형태에서 정수 형태로 변환

1. 특수 문자가 있다면 nan(결측값)으로 변환
2. nan 값이 있다면 0으로 변환 
3. df = df.astype({’열’ : ‘int’})를 이용해 정수로 변환

```python
import pandas as pd

df = pd.DataFrame({'판매일' : ['5/11/21', '5/12/21', '5/13/21', '5/14/21', '5/15/21'], '판매량' : ['10', '15', '20', '25', '30'], '방문자수' : ['10','-', '17', '23', '25'], '기온' : ['24.1', '24.3', '24.8', '25', '25.4']})
df['방문자수'] = pd.to_numeric(df['방문자수'], errors='coerce')
df.fillna(0, inplace = True)
# nan값을 0으로 변환
df = df.astype(({'방문자수' : 'int'}))
print(df)

'''
   판매일 판매량  방문자수    기온
0  5/11/21  10    10  24.1
1  5/12/21  15     0  24.3
2  5/13/21  20    17  24.8
3  5/14/21  25    23    25
4  5/15/21  30    25  25.4
'''
```

## datetime

### 예제3)

- 판매일을 datetime 의 형태로 바꾸시오

```python
import pandas as pd

df = pd.DataFrame({'판매일' : ['5/11/21', '5/12/21', '5/13/21', '5/14/21', '5/15/21'], '판매량' : ['10', '15', '20', '25', '30'], '방문자수' : ['10','-', '17', '23', '25'], '기온' : ['24.1', '24.3', '24.8', '25', '25.4']})
df['방문자수'] = pd.to_numeric(df['방문자수'], errors='coerce')
df.fillna(0, inplace = True)
df = df.astype(({'방문자수' : 'int'}))
df['판매일'] = pd.to_datetime(df['판매일'], format='%m/%d/%y')
print(df)

'''
     판매일 판매량  방문자수    기온
0 2021-05-11  10    10  24.1
1 2021-05-12  15     0  24.3
2 2021-05-13  20    17  24.8
3 2021-05-14  25    23    25
4 2021-05-15  30    25  25.4
'''
```

# 10. 레코드, 칼럼 추가 삭제

```python
import pandas as pd
df = pd.DataFrame([{'a' : [1, 1, 3, 4, 5], 'b' : [2, 3, 2, 3, 4], 'c' : [3, 4, 7, 6, 4]}])
print(df)

'''
          a                b                c
0  [1, 1, 3, 4, 5]  [2, 3, 2, 3, 4]  [3, 4, 7, 6, 4]
'''
```

### 예제1)

- 1, 3, 6, 4, 8로 이루어진 d 칼럼을 추가하시오.

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 1, 3, 4, 5], 'b' : [2, 3, 2, 3, 4], 'c' : [3, 4, 7, 6, 4]})
df['d'] = [1, 3, 6, 4, 8]
print(df)

'''
   a  b  c  d
0  1  2  3  1
1  1  3  4  3
2  3  2  7  6
3  4  3  6  4
4  5  4  4  8
'''
```

### 예제2)

- 1로 이루어진 e칼럼을 추가하시오.

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 1, 3, 4, 5], 'b' : [2, 3, 2, 3, 4], 'c' : [3, 4, 7, 6, 4]})
df['d'] = [1, 3, 6, 4, 8]
df['e'] = [1, 1, 1, 1, 1]
print(df)

'''
   a  b  c  d  e
0  1  2  3  1  1
1  1  3  4  3  1
2  3  2  7  6  1
3  4  3  6  4  1
4  5  4  4  8  1
'''
```

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 1, 3, 4, 5], 'b' : [2, 3, 2, 3, 4], 'c' : [3, 4, 7, 6, 4]})
df['d'] = [1, 3, 6, 4, 8]
df['e'] = 1
print(df)

'''
   a  b  c  d  e
0  1  2  3  1  1
1  1  3  4  3  1
2  3  2  7  6  1
3  4  3  6  4  1
4  5  4  4  8  1
'''
같은 값일 경우, 하나만 적어도 됨
```

### 예제3)

- a+b-c의 결과로 이루어진 f 칼럼을 추가하시오.

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 1, 3, 4, 5], 'b' : [2, 3, 2, 3, 4], 'c' : [3, 4, 7, 6, 4]})
df['d'] = [1, 3, 6, 4, 8]
df['e'] = 1
df['f'] = df['a'] + df['b'] - df['c']
print(df)

'''
   a  b  c  d  e  f
0  1  2  3  1  1  0
1  1  3  4  3  1  0
2  3  2  7  6  1 -2
3  4  3  6  4  1  1
4  5  4  4  8  1  5
'''
```

## 칼럼 삭제

### 예제4)

- 칼럼 d, e, f를 삭제하시오.

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 1, 3, 4, 5], 'b' : [2, 3, 2, 3, 4], 'c' : [3, 4, 7, 6, 4]})
df['d'] = [1, 3, 6, 4, 8]
df['e'] = 1
df['f'] = df['a'] + df['b'] - df['c']
df.drop(['d', 'e', 'f'], axis=1, inplace=True)
print(df)

'''
   a  b  c
0  1  2  3
1  1  3  4
2  3  2  7
3  4  3  6
4  5  4  4
'''
drop으로 칼럼을 삭제하겠다.
axis=1 -> 칼럼 기준으로 . 라는 뜻
```

## 레코드 추가(가로열, 행)

### 예제5)

- a에는 6, b에는 7, c에는 8을 추가하시오.

df._append()

ignore_index = True 옵션을 사용해 에러 해결

```python
import pandas as pd
df = pd.DataFrame({'a' : [1, 1, 3, 4, 5], 'b' : [2, 3, 2, 3, 4], 'c' : [3, 4, 7, 6, 4]})
df['d'] = [1, 3, 6, 4, 8]
df['e'] = 1
df['f'] = df['a'] + df['b'] - df['c']
df.drop(['d', 'e', 'f'], axis=1, inplace=True)
df.append({'a' : 6, 'b' : 7, 'c' : 8})
print(df)

'''
AttributeError: 'DataFrame' object has no attribute 'append'. Did you mean: '_append'?
'''
```

```python
import pandas as pd

df = pd.DataFrame({'a': [1, 1, 3, 4, 5], 'b': [2, 3, 2, 3, 4], 'c': [3, 4, 7, 6, 4]})

df['d'] = [1, 3, 6, 4, 8]
df['e'] = 1
df['f'] = df['a'] + df['b'] - df['c']
df.drop(['d', 'e', 'f'], axis=1, inplace=True)
df = df._append({'a': 6, 'b': 7, 'c': 8}, ignore_index=True)
print(df)

'''
   a  b  c
0  1  2  3
1  1  3  4
2  3  2  7
3  4  3  6
4  5  4  4
5  6  7  8
'''
inplace=True가 안되므로
df = df~~로 저장 후 출력
```

### 예제6)

- a에는 7, b에는 8, c에는 9를 추가하시오.

```python
import pandas as pd

df = pd.DataFrame({'a': [1, 1, 3, 4, 5], 'b': [2, 3, 2, 3, 4], 'c': [3, 4, 7, 6, 4]})

df['d'] = [1, 3, 6, 4, 8]
df['e'] = 1
df['f'] = df['a'] + df['b'] - df['c']
df.drop(['d', 'e', 'f'], axis=1, inplace=True)
df.loc[6] = [7, 8, 9]
print(df)

'''
   a  b  c
0  1  2  3
1  1  3  4
2  3  2  7
3  4  3  6
4  5  4  4
6  7  8  9
'''
예제5)와 같은 값이 도출.

```

### 예제7)

- 첫 번째 레코드를 삭제하시오.

```python
import pandas as pd

df = pd.DataFrame({'a': [1, 1, 3, 4, 5], 'b': [2, 3, 2, 3, 4], 'c': [3, 4, 7, 6, 4]})

df['d'] = [1, 3, 6, 4, 8]
df['e'] = 1
df['f'] = df['a'] + df['b'] - df['c']
df.drop(['d', 'e', 'f'], axis=1, inplace=True)
df.loc[6] = [7, 8, 9]
df.drop(0, inplace=True)
print(df)

'''
   a  b  c
1  1  3  4
2  3  2  7
3  4  3  6
4  5  4  4
6  7  8  9
'''
```

### 예제8)

- 첫 번째와 두번째 레코드를 삭제하시오.

```python
import pandas as pd

df = pd.DataFrame({'a': [1, 1, 3, 4, 5], 'b': [2, 3, 2, 3, 4], 'c': [3, 4, 7, 6, 4]})

df['d'] = [1, 3, 6, 4, 8]
df['e'] = 1
df['f'] = df['a'] + df['b'] - df['c']
df.drop(['d', 'e', 'f'], axis=1, inplace=True)
df.loc[6] = [7, 8, 9]
df.drop([0, 1], inplace=True)
print(df)

'''
   a  b  c
2  3  2  7
3  4  3  6
4  5  4  4
6  7  8  9
'''
```

# 11. apply, map을 활용한 데이터변환

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3, 4,5]})
print(df)

'''
   a
0  1
1  2
2  3
3  4
4  5
'''
```

### 예제1)

- a가 2보다 작으면 ‘2 미만’, 4보다 작으면 ‘4 미만’, 4보다 크면 ‘4 이상’ 이 저장된 b칼럼을 추가하시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3, 4,5]})
df['b'] = 0
a = df[df['a'] < 2]
print(a)

'''
   a  b
0  1  0
'''
```

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3, 4,5]})
df['b'] = 0
a = df[df['a'] < 2]
df['b'][a.index] = '2미만'
print(df)

'''
   a    b
0  1  2미만
1  2    0
2  3    0
3  4    0
4  5    0
'''
```

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3, 4,5]})
df['b'] = 0
a = df[df['a'] < 2]
df['b'][a.index] = '2미만'
a = df[(df['a'] >= 2)&(df['a'] < 4)]
print(a)

'''
   a  b
1  2  0
2  3  0
'''
```

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3, 4,5]})
df['b'] = 0
a = df[df['a'] < 2]
df['b'][a.index] = '2미만'
a = df[(df['a'] >= 2)&(df['a'] < 4)]
df['b'][a.index] = '4미만'
print(df)

'''
   a    b
0  1  2미만
1  2  4미만
2  3  4미만
3  4    0
4  5    0
'''
```

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3, 4,5]})
df['b'] = 0
a = df[df['a'] < 2]
df['b'][a.index] = '2미만'
a = df[(df['a'] >= 2)&(df['a'] < 4)]
df['b'][a.index] = '4미만'
a = df[(df['a'] >= 4)]
df['b'][a.index] = '4이상'
print(df)

'''
   a    b
0  1  2미만
1  2  4미만
2  3  4미만
3  4  4이상
4  5  4이상
'''
```

### 예제2)

- 함수의 사용으로 전 문제 풀기

apply

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3, 4,5]})
def case_function(x):
    if x < 2:
        return '2 미만'
    elif x < 4:
        return '4 미만'
    else:
        return '4 이상'

df['b'] = df['a'].apply(case_function)
print(df)

'''
   a     b
0  1  2 미만
1  2  4 미만
2  3  4 미만
3  4  4 이상
4  5  4 이상
'''
```

### 예제3)

- a 가 1이면 ‘one’, 2이면 ‘two’, 3이면 ‘three’, 4이면 ‘four’, 5이면 ‘five’를 출력하는 칼럼 d를 만드시오.

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3, 4,5]})
def case_function(x):
    if x == 1:
        return 'one'
    elif x == 2:
        return 'two'
    elif x == 3:
        return 'three'
    elif x == 4:
        return 'four'
    elif x == 5:
        return 'five'

df['d'] = df['a'].apply(case_function)
print(df)

'''
   a      d
0  1    one
1  2    two
2  3  three
3  4   four
4  5   five
'''
```

### 예제4)

- map을 이용한 해결 방법

```python
import pandas as pd

df = pd.DataFrame({'a' : [1, 2, 3, 4,5]})
def case_function(x):
    if x == 1:
        return 'one'
    elif x == 2:
        return 'two'
    elif x == 3:
        return 'three'
    elif x == 4:
        return 'four'
    elif x == 5:
        return 'five'

df['d'] = df['a'].apply(case_function)

a = {1 : 'one', 2 : 'two', 3 : 'three', 4 : 'four', 5 : 'five'}
df['e'] = df['a'].map(a)
#칼럼명e 정의 = df a의 열에 a라는 변수를 매칭 시켜라

print(df)

'''
   a      d      e
0  1    one    one
1  2    two    two
2  3  three  three
3  4   four   four
4  5   five   five
'''

```

# 12. 데이터프레임 결합_상하 결합

### 데이터 프레임 결합

- 상하 결합
- 좌우 결합

## 상하 결합

pd.concat()

```python
import pandas as pd

df1 = pd.DataFrame({'A' : [1, 2, 3], 'B' : [11, 12, 13], 'C' : [21, 22, 23]})
df2 = pd.DataFrame({'A' : [4, 5, 6], 'B' : [14, 15, 16], 'C' : [24, 25, 26]})
print(pd.concat([df1, df2]))
print(pd.concat([df2, df1]))

'''
   A   B   C
0  1  11  21
1  2  12  22
2  3  13  23
0  4  14  24
1  5  15  25
2  6  16  26
'''

'''
   A   B   C
0  4  14  24
1  5  15  25
2  6  16  26
0  1  11  21
1  2  12  22
2  3  13  23
'''
```

index 초기화를 위해서는 ignore_index=True

```python
import pandas as pd

df1 = pd.DataFrame({'A' : [1, 2, 3], 'B' : [11, 12, 13], 'C' : [21, 22, 23]})
df2 = pd.DataFrame({'A' : [4, 5, 6], 'B' : [14, 15, 16], 'C' : [24, 25, 26]})
print(pd.concat([df2, df1], ignore_index = True))

'''
   A   B   C
0  4  14  24
1  5  15  25
2  6  16  26
3  1  11  21
4  2  12  22
5  3  13  23
'''
```

### 필드의 순서가 섞였을 때 결합 결과 확인

```python
import pandas as pd

df1 = pd.DataFrame({'A' : [1, 2, 3], 'B' : [11, 12, 13], 'C' : [21, 22, 23]})
df2 = pd.DataFrame({'B' : [14, 15, 16], 'A' : [4, 5, 6], 'C' : [24, 25, 26]})
print(pd.concat([df1, df2], ignore_index=True))

'''
   A   B   C
0  1  11  21
1  2  12  22
2  3  13  23
3  4  14  24
4  5  15  25
5  6  16  26
'''
#자리를 잘 찾아서 결합했다.
```

### 서로 다른 필드로 구성되어 있는 데이터 프레임의 결합

```python
import pandas as pd

df1 = pd.DataFrame({'A' : [1, 2, 3], 'B' : [11, 12, 13], 'C' : [21, 22, 23], 'D' : [31, 32, 33]})
df2 = pd.DataFrame({'A' : [4, 5, 6], 'B' : [14, 15, 16], 'C' : [24, 25, 26], 'E' : [41, 42, 43]})
print(pd.concat([df2, df1], ignore_index = True))

'''
   A   B   C     E     D
0  4  14  24  41.0   NaN
1  5  15  25  42.0   NaN
2  6  16  26  43.0   NaN
3  1  11  21   NaN  31.0
4  2  12  22   NaN  32.0
5  3  13  23   NaN  33.0
'''
결측값으로 정리 되었다.
```

join = outter (합집합)

```python
import pandas as pd

df1 = pd.DataFrame({'A' : [1, 2, 3], 'B' : [11, 12, 13], 'C' : [21, 22, 23], 'D' : [31, 32, 33]})
df2 = pd.DataFrame({'A' : [4, 5, 6], 'B' : [14, 15, 16], 'C' : [24, 25, 26], 'E' : [41, 42, 43]})
print(pd.concat([df2, df1], join = 'outer', ignore_index = True))

'''
   A   B   C     E     D
0  4  14  24  41.0   NaN
1  5  15  25  42.0   NaN
2  6  16  26  43.0   NaN
3  1  11  21   NaN  31.0
4  2  12  22   NaN  32.0
5  3  13  23   NaN  33.0
'''
outer join 옵션은 E와 D의 합집합을 의미
```

join = inner (교집합)

```python
import pandas as pd

df1 = pd.DataFrame({'A' : [1, 2, 3], 'B' : [11, 12, 13], 'C' : [21, 22, 23], 'D' : [31, 32, 33]})
df2 = pd.DataFrame({'A' : [4, 5, 6], 'B' : [14, 15, 16], 'C' : [24, 25, 26], 'E' : [41, 42, 43]})
print(pd.concat([df2, df1], join = 'inner', ignore_index = True))

'''
   A   B   C
0  4  14  24
1  5  15  25
2  6  16  26
3  1  11  21
4  2  12  22
5  3  13  23
'''
D와 E의 교집합만 출력하겠다.
```

# 13. 데이터 프레임 결합_좌우 결합

pd.concat에 옵션(axis = 1)을 붙이기만 하면 된다.

```python
import pandas as pd

df1 = pd.DataFrame({'A' : [1, 2, 3], 'B' : [11, 12, 13], 'C' : [21, 22, 23], 'D' : [31, 32, 33]})
df2 = pd.DataFrame({'E' : [3, 4, 5], 'F' : [13, 14, 15], 'G' : [23, 24, 25], 'H' : [41, 42, 43]})
print(pd.concat([df1, df2], axis = 1))

'''
   A   B   C   D  E   F   G   H
0  1  11  21  31  3  13  23  41
1  2  12  22  32  4  14  24  42
2  3  13  23  33  5  15  25  43
'''
```

### 예제1)

- 다음 두 데이터 프레임을 결합하시오.

```python
import pandas as pd

df1 = pd.DataFrame({'ID' : [1, 2, 3], '성별' : ['F', 'M', 'F'], '나이' : [20, 30, 40]})
df2 = pd.DataFrame({'ID' : [1, 2, 3], '키' : [160.5, 170.3, 180.1], '몸무게' : [45.1, 50.3, 72.1]})
print(pd.concat([df1, df2], axis = 1))

'''
   ID 성별  나이  ID      키   몸무게
0   1  F  20   1  160.5  45.1
1   2  M  30   2  170.3  50.3
2   3  F  40   3  180.1  72.1
'''
```

### 예제2)

- 다음 두 데이터 프레임을 ID를 기준으로 결합하시오.

```python
import pandas as pd

df1 = pd.DataFrame({'ID' : [1, 2, 3, 4, 5], '성별' : ['F', 'M', 'F', 'M', 'F'], '나이' : [20, 30, 40, 25, 42]})
df2 = pd.DataFrame({'ID' : [3, 4, 5, 6, 7], '키' : [160.5, 170.3, 180.1, 142.3, 153.7], '몸무게' : [45.1, 50.3, 72.1, 38, 42]})
print(pd.concat([df1, df2], axis = 1))

'''
ID 성별  나이  ID      키   몸무게
0   1  F  20   3  160.5  45.1
1   2  M  30   4  170.3  50.3
2   3  F  40   5  180.1  72.1
3   4  M  25   6  142.3  38.0
4   5  F  42   7  153.7  42.0
'''
```

### 예제3)

- 성별과 나이가 확인 된 유저들을 대상으로 키와 몸무게의 정보를 결합하시오.

leftjoin → A를 기준으로 합집합

pd.merge() 이용

```python
import pandas as pd

df1 = pd.DataFrame({'ID' : [1, 2, 3, 4, 5], '성별' : ['F', 'M', 'F', 'M', 'F'], '나이' : [20, 30, 40, 25, 42]})
df2 = pd.DataFrame({'ID' : [3, 4, 5, 6, 7], '키' : [160.5, 170.3, 180.1, 142.3, 153.7], '몸무게' : [45.1, 50.3, 72.1, 38, 42]})
print(pd.merge(df1, df2, how = 'left', on = 'ID'))

'''
   ID 성별 나이   키   몸무게
0   1  F  20    NaN   NaN
1   2  M  30    NaN   NaN
2   3  F  40  160.5  45.1
3   4  M  25  170.3  50.3
4   5  F  42  180.1  72.1
'''
```

### 예제4)

- 키와 몸무게가 확인 된 유저들을 성별과 나이의 정보를 결합하시오.

```python
import pandas as pd

df1 = pd.DataFrame({'ID' : [1, 2, 3, 4, 5], '성별' : ['F', 'M', 'F', 'M', 'F'], '나이' : [20, 30, 40, 25, 42]})
df2 = pd.DataFrame({'ID' : [3, 4, 5, 6, 7], '키' : [160.5, 170.3, 180.1, 142.3, 153.7], '몸무게' : [45.1, 50.3, 72.1, 38, 42]})
print(pd.merge(df2, df1, how = 'left', on = 'ID'))

'''
   ID    키   몸무게   성별   나이
0   3  160.5  45.1    F  40.0
1   4  170.3  50.3    M  25.0
2   5  180.1  72.1    F  42.0
3   6  142.3  38.0  NaN   NaN
4   7  153.7  42.0  NaN   NaN
'''
#또는 right를 사용
```

### 예제5)

- 키, 몸무게, 성별, 나이 정보가 모두 확인 된 유저들의 정보를 출력하시오.

```python
import pandas as pd

df1 = pd.DataFrame({'ID' : [1, 2, 3, 4, 5], '성별' : ['F', 'M', 'F', 'M', 'F'], '나이' : [20, 30, 40, 25, 42]})
df2 = pd.DataFrame({'ID' : [3, 4, 5, 6, 7], '키' : [160.5, 170.3, 180.1, 142.3, 153.7], '몸무게' : [45.1, 50.3, 72.1, 38, 42]})
print(pd.merge(df2, df1, how = 'inner', on = 'ID'))

'''
    ID  키   몸무게 성별  나이
0   3  160.5  45.1  F  40
1   4  170.3  50.3  M  25
2   5  180.1  72.1  F  42
'''
```

### 예제6)

- 모든 유저들의 정보를 출력하시오.

```python
import pandas as pd

df1 = pd.DataFrame({'ID' : [1, 2, 3, 4, 5], '성별' : ['F', 'M', 'F', 'M', 'F'], '나이' : [20, 30, 40, 25, 42]})
df2 = pd.DataFrame({'ID' : [3, 4, 5, 6, 7], '키' : [160.5, 170.3, 180.1, 142.3, 153.7], '몸무게' : [45.1, 50.3, 72.1, 38, 42]})
print(pd.merge(df2, df1, how = 'outer', on = 'ID'))

'''
    ID  키   몸무게   성별    나이
0   3  160.5  45.1    F  40.0
1   4  170.3  50.3    M  25.0
2   5  180.1  72.1    F  42.0
3   6  142.3  38.0  NaN   NaN
4   7  153.7  42.0  NaN   NaN
5   1    NaN   NaN    F  20.0
6   2    NaN   NaN    M  30.0
'''
```

# 14. 그룹화

### 예제1)

- df1 은 회원의 정보를 저장한 데이터 프레임이며, df2는 각 회원의 구매 내역을 저장한 데이터 프레임이다. 각 회원의 정보와 구매 내역을 취합하여 하나의 데이터 프레임으로 만드시오.

```python
import pandas as pd

df1 = pd.DataFrame({'ID' : [1, 2, 3, 4, 5], '가입일' : ['2021-01-02', '2021-01-04', '2021-01-10', '2021-02-10', '2021-02-24'], '성별' : ['F', 'M', 'F', 'M', 'M']})
df2 = pd.DataFrame({'구매순서' : [1, 2, 3, 4, 5], 'ID' : [1, 1, 2, 4, 1], '구매월' : [1, 1, 2, 2, 3], '금액' : [1000, 1500, 2000, 3000, 4000]})
print(pd.merge(df1, df2, how = 'left', on = 'ID'))

'''
    ID  가입일   성별  구매순서  구매월      금액
0   1  2021-01-02  F   1.0  1.0  1000.0
1   1  2021-01-02  F   2.0  1.0  1500.0
2   1  2021-01-02  F   5.0  3.0  4000.0
3   2  2021-01-04  M   3.0  2.0  2000.0
4   3  2021-01-10  F   NaN  NaN     NaN
5   4  2021-02-10  M   4.0  2.0  3000.0
6   5  2021-02-24  M   NaN  NaN     NaN
'''
```

### 예제2)

- df1은 회원의 정보를 저장한 데이터 프레임이며, df2는 각 회원의 구매 내역을 저장한 데이터 프레임이다. 각 회원의 누적 금액을 회원 ID 별로 구하시오.

groupby → 어떤 기준을 통해서 내가 원하는 다른것의 합계 or 평균 등 통계적인 결과를 낼 때 사용

```python
import pandas as pd

df1 = pd.DataFrame({'ID' : [1, 2, 3, 4, 5], '가입일' : ['2021-01-02', '2021-01-04', '2021-01-10', '2021-02-10', '2021-02-24'], '성별' : ['F', 'M', 'F', 'M', 'M']})
df2 = pd.DataFrame({'구매순서' : [1, 2, 3, 4, 5], 'ID' : [1, 1, 2, 4, 1], '구매월' : [1, 1, 2, 2, 3], '금액' : [1000, 1500, 2000, 3000, 4000]})
print(df2.groupby(by = ['ID'])['금액'].sum())

'''
ID
1    6500
2    2000
4    3000
Name: 금액, dtype: int64
'''
#series 형태로 나옴
```

ID를 기준으로 그룹화를 할 것이다.

그 그룹화를 토대로 금액의 합계를 구한다.

```python
import pandas as pd

df1 = pd.DataFrame({'ID' : [1, 2, 3, 4, 5], '가입일' : ['2021-01-02', '2021-01-04', '2021-01-10', '2021-02-10', '2021-02-24'], '성별' : ['F', 'M', 'F', 'M', 'M']})
df2 = pd.DataFrame({'구매순서' : [1, 2, 3, 4, 5], 'ID' : [1, 1, 2, 4, 1], '구매월' : [1, 1, 2, 2, 3], '금액' : [1000, 1500, 2000, 3000, 4000]})
s2 = df2.groupby(by = ['ID'])['금액'].sum()
print(pd.merge(df1, s2, how = "left", on = 'ID'))

'''
   ID       가입일 성별      금액
0   1  2021-01-02  F  6500.0
1   2  2021-01-04  M  2000.0
2   3  2021-01-10  F     NaN
3   4  2021-02-10  M  3000.0
4   5  2021-02-24  M     NaN
'''
```

### 예제3)

- df1은 회원의 정보를 저장한 데이터 프레임이며, df2는 각 회원의 구매 내역을 저장한 데이터 프레임이다. 각 회원의 월별 누적 금액을 회원 ID별로 구하시오.

```python
import pandas as pd

df1 = pd.DataFrame({'ID' : [1, 2, 3, 4, 5], '가입일' : ['2021-01-02', '2021-01-04', '2021-01-10', '2021-02-10', '2021-02-24'], '성별' : ['F', 'M', 'F', 'M', 'M']})
df2 = pd.DataFrame({'구매순서' : [1, 2, 3, 4, 5], 'ID' : [1, 1, 2, 4, 1], '구매월' : [1, 1, 2, 2, 3], '금액' : [1000, 1500, 2000, 3000, 4000]})
s2 = df2.groupby(by = ['ID', '구매월'])['금액'].sum()
print(pd.merge(df1, s2, how = "left", on = "ID"))

'''
    ID      가입일 성별      금액
0   1  2021-01-02  F  2500.0
1   1  2021-01-02  F  4000.0
2   2  2021-01-04  M  2000.0
3   3  2021-01-10  F     NaN
4   4  2021-02-10  M  3000.0
5   5  2021-02-24  M     NaN
'''

```

→ 구매월이 누락됨.

- 그룹을 index로 사용하고 싶지 않은 경우에는 as_index = False 로 설정

```python
import pandas as pd

df1 = pd.DataFrame({'ID' : [1, 2, 3, 4, 5], '가입일' : ['2021-01-02', '2021-01-04', '2021-01-10', '2021-02-10', '2021-02-24'], '성별' : ['F', 'M', 'F', 'M', 'M']})
df2 = pd.DataFrame({'구매순서' : [1, 2, 3, 4, 5], 'ID' : [1, 1, 2, 4, 1], '구매월' : [1, 1, 2, 2, 3], '금액' : [1000, 1500, 2000, 3000, 4000]})
s2 = df2.groupby(by = ['ID', '구매월'], as_index = False)['금액'].sum()
print(pd.merge(df1, s2, how = "left", on = "ID"))

'''
    ID     가입일 성별  구매월      금액
0   1  2021-01-02  F  1.0  2500.0
1   1  2021-01-02  F  3.0  4000.0
2   2  2021-01-04  M  2.0  2000.0
3   3  2021-01-10  F  NaN     NaN
4   4  2021-02-10  M  2.0  3000.0
5   5  2021-02-24  M  NaN     NaN
'''
```

### 예제5)

- df는 각 회원의 구매 내역을 저장한 데이터 프레임이다. 각 회원의 누적 금액과 누적 구매 횟수를 회원 ID 별로 구하시오.

agg 함수 → 여러가지 통계결과를 한 번에 출력

```python
import pandas as pd

df = pd.DataFrame({'구매순서' : [1, 2, 3, 4, 5], 'ID' : [1, 1, 2, 4, 1], '구매월' : [1, 1, 2, 2, 3], '금액' : [1000, 1500, 2000, 3000, 4000], '수수료' : [100, 150, 200, 300, 400]})
print(df.groupby(by = ['ID'])['금액'].agg([sum, len]))

'''
    sum  len
ID           
1   6500    3
2   2000    1
4   3000    1
'''
```

index 재정렬을 해준다

```python
import pandas as pd

df = pd.DataFrame({'구매순서' : [1, 2, 3, 4, 5], 'ID' : [1, 1, 2, 4, 1], '구매월' : [1, 1, 2, 2, 3], '금액' : [1000, 1500, 2000, 3000, 4000], '수수료' : [100, 150, 200, 300, 400]})
df2 = (df.groupby(by = ['ID'])['금액'].agg([sum, len]))
(df2.reset_index(inplace=True))
print(df2)

'''
   ID   sum  len
0   1  6500    3
1   2  2000    1
2   4  3000    1

'''
```

# 15. 피벗테이블

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'가입월' : [1, 1, 1, 2, 2, 3], '탈퇴월' : [1, 2, 3, 2, 3, 3], '탈퇴회원수' : [101, 52, 30, 120, 60, 130]})
print(df)

'''
   가입월  탈퇴월  탈퇴회원수
0    1    1    101
1    1    2     52
2    1    3     30
3    2    2    120
4    2    3     60
5    3    3    130
'''
```

## 피벗테이블 만들기

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'가입월' : [1, 1, 1, 2, 2, 3], '탈퇴월' : [1, 2, 3, 2, 3, 3], '탈퇴회원수' : [101, 52, 30, 120, 60, 130]})
pivot = pd.pivot_table(df, values = '탈퇴회원수' , index = ['가입월'], columns = ['탈퇴월'], fill_value = 0 )
print(pivot)

'''
탈퇴월  1    2    3
가입월               
1    101   52   30
2      0  120   60
3      0    0  130
'''

```

이러한 형식을 피벗테이블이라 한다.

### 예제1)

- 다음 데이터 프레임은 어느 과일 매장의 판매내역이다. 각 상품 항목 별, 크기 별로 판매 개수와 판매 금액의 합을 구하시오.

## random 라이브러리

random.randint(초기값, 마지막값)

```python
import pandas as pd
import numpy as np
import random

a = []
b = []

for i in range(100):
    a.append(random.randint(1,3))
    b.append(random.randint(1,3))
df = pd.DataFrame({'품목' : a, '크기' : b})
df['금액'] = df['품목'] * df['크기'] * 500
df['수수료'] = df['금액'] * 0.1
fruit_name = {1 : '토마토', 2 : '바나나', 3 : '사과'}
fruit_size = {1 : '소', 2 : '중', 3 : '대'}

df['품목'] = df['품목'].map(fruit_name)
df['크기'] = df['크기'].map(fruit_size)
print(df)

'''
     품목 크기    금액    수수료
0   바나나  소  1000  100.0
1    사과  대  4500  450.0
2    사과  소  1500  150.0
3    사과  대  4500  450.0
4    사과  대  4500  450.0
..  ... ..   ...    ...
95  토마토  중  1000  100.0
96  토마토  중  1000  100.0
97   사과  중  3000  300.0
98   사과  중  3000  300.0
99  바나나  대  3000  300.0

[100 rows x 4 columns]
'''
```

```python
import pandas as pd
import numpy as np
import random

a = []
b = []

for i in range(100):
    a.append(random.randint(1,3))
    b.append(random.randint(1,3))
df = pd.DataFrame({'품목' : a, '크기' : b})
df['금액'] = df['품목'] * df['크기'] * 500
df['수수료'] = df['금액'] * 0.1
fruit_name = {1 : '토마토', 2 : '바나나', 3 : '사과'}
fruit_size = {1 : '소', 2 : '중', 3 : '대'}
df['품목'] = df['품목'].map(fruit_name)
df['크기'] = df['크기'].map(fruit_size)
df2 = pd.pivot_table(df, values = '금액', index = ['품목'], columns = ['크기'], aggfunc = ( 'count', 'sum'))
print(df2)

'''
      count            sum              
크기      대   소   중      대      소      중
품목                                    
바나나    14   6   9  42000   6000  18000
사과      9  10  12  40500  15000  36000
토마토    17  14   9  25500   7000   9000
'''

```

# 16. 파일호출_저장

### 파일 호출

df = pd.read_csv(파일 경로.csv)

### 파일의 양이 많은 경우 요약하는 방법

| df.head() | 처음부터 5행까지 출력 |
| --- | --- |
| df.tail() | 뒤에서부터 5행까지 출력 |
- 구분자가 , 가 아닌 다른 기호인 경우
    
    ```python
    df = pd.read_csv('파일경로.txt', index_col = 0, sep = '다른기호')
    ```
    
- header가 여러줄인 경우 ( 멀티헤더(칼럼 여러줄))
    
    ```python
    df = pd.read_csv('파일경로.csv', header = 1)
    ```
    
    두번째 까지는 header고 나머지는 데이터다. 라는 뜻.
    
- 데이터를 읽으면서 칼럼명을 추가하고 싶을 때
    
    ```python
    df = pd.read_csv('파일경로.csv', index_col = 0, names = ['품목', '크기', '금액', '수수료']
    ```
    
- 원하는 칼럼만 쓰고 싶을 때
    
    ```python
    df = pd.read_csv('파일경로.csv',usecols = ['품목', '크기'])
    ```
    

 

### 파일 저장

```python
df.to_csv('파일경로csv.csv')
```
